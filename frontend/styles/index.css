@import "./fonts.css";
@import "./blobs.css";
@import "./callouts.css";
/* =========================
   Variables
   ========================= */
:root {
    --sans-serif:
        "Rubik", BlinkMacSystemFont, -apple-system, "Segoe UI", "Roboto",
        "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",
        "Helvetica Neue", "Helvetica", "Arial", sans-serif;
    --secondary-font: var(--sans-serif);
    --serif:
        "Source Serif 4", "Charter", "Georgia", "Palatino", "Palatino Linotype",
        "Book Antiqua", "Minion Pro", "Iowan Old Style", "Sitka Text", serif;
    --primary-font: var(--serif);

    --base-font-size: 17px;
    --base-line-height: 28px; /* baseline step */
    --secondary-font-adjust: 0.52;

    --background: #fffff8;
    --background-10: #f0f0ea;
    --background-20: #e7e6de;

    --primary: #211618;
    --primary-10: #666666;
    --primary-20: #aaaaaa;
    --primary-25: #cccccc;
    --primary-30: #dddddd;
    --primary-40: #eeeeee;

    --accent-red: #ed355d;
    --accent-yellow: #ffe922;
    --accent-green: #5e8d58;
    --accent: var(--accent-red);

    --ear: var(--base-line-height);
    --main-content-width: 41rem;
    --main-content-width-unbounded: 100%;
}

/* RTL Hebrew specifics */
:lang(he) {
    font-family: var(--serif);
    direction: rtl;
    unicode-bidi: isolate;
}

/* =========================
   Base
   ========================= */
html {
    scroll-behavior: smooth;
    width: 100%;
    min-height: 100%;
    font-size: var(--base-font-size);
    line-height: var(--base-line-height); /* 1rlh = 28px */
}

body {
    font-family: var(--primary-font);
    font-optical-sizing: auto;
    color: var(--primary);
    display: flex;
    flex-direction: column;
    width: 100%;
    height: auto;
    min-height: 100vh;
    margin: 0;
    padding: 0;
    background-color: var(--background);
}

@supports (min-height: 100svh) {
    body {
        min-height: 100svh;
    }
}

main {
    flex: 1 1 auto;
    position: relative;
}
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

a {
    color: var(--accent-green);
    text-decoration-thickness: 1px;
    text-underline-offset: 0.24rem;
    text-decoration-color: oklch(from currentColor l c h / 50%);
}
/* =========================
   Baseline + Typographic defaults
   ========================= */

/* Line-height for text-bearing elements (no margins here) */
:where(
    p,
    li,
    dt,
    dd,
    blockquote,
    pre,
    table,
    caption,
    figcaption,
    code,
    kbd,
    samp,
    aside
) {
    line-height: 1rlh;
}

/* Headings: consistent, grid-safe line-height */
h1,
h2,
h3,
h4,
h5,
h6,
.footnotes::before {
    font-family: var(--secondary-font);
    font-size-adjust: var(--secondary-font-adjust);
    text-align: start;
    text-wrap: balance;
    font-weight: 500;
}

/* Use integer multiples of the baseline for multi-line safety */
h1,
h2,
h3 {
    line-height: 2rlh;
}
h4,
h5,
h6 {
    line-height: 1rlh;
}

/* Code sizing while keeping baseline */
pre,
code {
    font-size: 0.95rem;
}

/* UI blocks that should not hyphenate automatically */
.nav,
.ui,
code,
pre,
kbd,
samp,
table,
caption,
figcaption,
.footnotes {
    text-align: start;
    hyphens: manual;
    -webkit-hyphens: manual;
}

/* Images: block-level to avoid inline line-box artifacts */
img {
    display: block;
    max-width: 100%;
    height: auto;
}

/* =========================
   Article content flow
   ========================= */

/* Spacing + width only on direct article children (prevents nested double margins) */
article
    > :where(
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        p,
        ul,
        ol,
        dl,
        blockquote,
        pre,
        figure,
        table,
        hr,
        .footnotes
    ),
footer > :where(p, ul),
figure figcaption {
    max-width: var(--main-content-width);
    margin-inline: auto;
    margin-block: 1rlh;
}

article > aside {
    max-width: calc(var(--main-content-width) + 2 * var(--ear));
    padding: 0 var(--ear);
    margin-inline: auto;
    margin-block: 1rlh;
    min-width: 0;
    & h4 {
        margin: 0;
    }
    & p {
        margin-inline: auto;
        margin-block: 1rlh;
    }
}

@media (max-width: 768px) {
    /* Higher than your current 1284px */
    article aside {
        margin-inline: calc(-1 * var(--ear));
        max-width: 100vw;
        border-radius: 0 !important;
    }
}

.footnotes::before {
    content: "Footnotes:";
    display: block;
}

/* Lists: control outer spacing on UL/OL, not on LI */
li {
    margin: 0;
}

figure figcaption {
    margin-block: 0.5rlh 0;
    color: var(--primary-10);
    font-family: var(--secondary-font);
    line-height: 0.8rlh;
    font-size: 1rem;
    font-weight: 300;
    & p {
        margin: 0;
        line-height: inherit;
        font-size: inherit;
        margin-block: inherit;
    }
}

/* Horizontal rule: 1px compensated to keep net advance = 1rlh */
hr {
    width: 80%;
    border: 0;
    height: 0;
    margin-block: calc(1rlh - 1px) 1rlh;
    border-top: 1px solid oklch(from currentColor l c h / 20%);
}

sup {
    vertical-align: baseline;
    position: relative;
    top: -0.4em;
    font-size: 0.75em;
    line-height: 0;
}
ul,
ol {
    padding-inline-start: 1rlh;
}

/* =========================
   Header / Main layout (nested syntax)
   ========================= */
header {
    box-sizing: border-box;
    padding: 0.5rlh var(--ear);

    & h1 {
        font-weight: 300;
        font-size: 1.6rem;
        line-height: 2rlh;
        margin-block: 0.5rlh;

        & a {
            color: var(--primary);
            -webkit-tap-highlight-color: transparent;
            text-decoration: none;
            display: flex;
            align-items: center;

            & img {
                width: 3rem;
                margin-right: var(--ear);
                margin-block: 0;
            }
        }

        & i {
            color: var(--accent);
            font-style: normal;
            padding: 0 0.4rem;
        }
    }
}

main {
    padding: 0.5rlh var(--ear);
    overflow-x: clip;

    & h1 {
        font-weight: 500;
        font-size: 3rem;
        line-height: 1.5rlh;
        margin-block: 2.5rlh 2rlh;
        /* letter-spacing: -0.03em; */
    }

    & h2 {
        font-size: 2.3rem;
        line-height: 1.5rlh;
        margin-block: 2rlh 1rlh;
    }

    & h3,
    .footnotes::before {
        font-size: 1.8rem;
        line-height: 1rlh;
        margin-block: 2rlh 0rlh;
    }

    & h4 {
        font-size: 1.4rem;
        line-height: 1rlh;
        margin-block: 1rlh 0.5rlh;
    }

    & h4 + p {
        margin-top: 0;
    }

    & p,
    & li {
        font-size: 1.15rem; /* â‰ˆ18.4px body size */
        font-weight: 400; /* baseline already set via :where(...) */
    }

    & figure img {
        max-width: 100%;
        height: auto;
    }

    & p img {
        max-width: 100%;
        height: auto;
    }
    & a {
        word-break: break-word;
        overflow-wrap: anywhere;
    }
}

/* =========================
   Media width variants
   ========================= */
article figure.unbounded,
article img.unbounded {
    max-width: fit-content;
}

article figure.wide,
article p:has(> img.wide) {
    max-width: calc(var(--main-content-width) + 200px);
}

.blog-meta {
    display: flex;
    gap: 1rlh;
    align-items: center;
    color: var(--primary-10);
    font-family: var(--secondary-font);
    font-size: 0.9rem;
    flex-wrap: wrap;
    margin-block-start: -1rlh;
}

.blog-meta dd {
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.25rem;
}
.blog-meta dd {
    position: relative;
}
.blog-meta + p {
    margin-block-start: 2rlh;
}

.time-meta::before {
    content: "~";
}

.author-meta::before {
    content: "by ";
    position: absolute;
    left: 0;
    font-style: italic;
}

footer {
    /*background-color: color-mix(in srgb, var(--accent-green) 50%, transparent);*/
    position: relative;
    flex-shrink: 0;
    padding-inline: var(--ear);
    padding-block: 2rlh;
    font-family: var(--secondary-font);
}

/* =========================
   Debug overlay
   ========================= */
body.debug-baseline {
    background-image: repeating-linear-gradient(
        to bottom,
        transparent 0,
        transparent calc(1rlh - 1px),
        rgba(237, 53, 93, 0.25) calc(1rlh - 1px),
        rgba(237, 53, 93, 0.25) 1rlh
    );
    background-size: 100% 1rlh;
}
